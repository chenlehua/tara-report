import{_ as ft,r as C,c as f,m as yt,p as kt,a as o,o as d,b as u,d as t,F as g,e as n,t as l,g as M,f as w,w as B,n as h}from"./index-BYRN50ky.js";import{getReport as gt,getImageUrl as bt,getDownloadUrl as wt}from"./index-fc_ROXrg.js";const xt={class:"report-detail-page animate-fadeIn"},Ct={key:0,class:"loading-state"},Mt={class:"detail-header"},It={class:"header-left"},At={class:"title-section"},Rt={class:"header-meta"},Lt={class:"meta-item"},St={class:"header-actions"},Dt=["href"],Vt={class:"stats-grid"},Tt={class:"stat-card"},Bt={class:"stat-info"},$t={class:"stat-value"},Ft={class:"stat-card"},qt={class:"stat-info"},Nt={class:"stat-value"},Et={class:"stat-card"},Ut={class:"stat-info"},zt={class:"stat-value"},Ht={class:"stat-card"},Wt={class:"stat-info"},Pt={class:"stat-value"},jt={class:"section-card"},Gt={class:"section-content"},Ot={class:"info-grid"},Qt={class:"info-item"},Jt={class:"info-value"},Kt={class:"info-item"},Xt={class:"info-value"},Yt={class:"info-item"},Zt={class:"info-value"},ta={class:"info-item"},aa={class:"info-value"},sa={class:"info-item"},la={class:"info-value"},ea={class:"info-item"},na={class:"info-value"},ia={key:0,class:"section-card"},oa={class:"section-content"},da={class:"images-grid"},ra=["src"],ua=["src"],ca=["src"],va=["src"],_a={key:1,class:"section-card"},ha={class:"section-content"},pa={class:"functional-desc"},ma={key:2,class:"section-card"},fa={class:"section-content"},ya={class:"data-table"},ka={key:3,class:"section-card"},ga={class:"section-content"},ba={class:"data-table"},wa={key:0,class:"attr-tag"},xa={key:1,class:"attr-tag"},Ca={key:2,class:"attr-tag"},Ma={key:3,class:"attr-tag"},Ia={key:4,class:"section-card"},Aa={class:"section-content"},Ra={class:"attack-trees-grid"},La={class:"attack-tree-header"},Sa={class:"tree-info"},Da={class:"tree-id"},Va={class:"tree-name"},Ta={class:"attack-tree-body"},Ba=["onClick"],$a=["src","alt"],Fa={key:1,class:"tree-placeholder"},qa={key:0,class:"attack-tree-footer"},Na={key:0,class:"tree-title"},Ea={key:1,class:"tree-desc"},Ua={key:5,class:"section-card"},za={class:"section-content"},Ha={class:"data-table clickable-table"},Wa=["onClick"],Pa={class:"stride-badge"},ja={class:"threat-cell"},Ga=["onClick"],Oa={key:6,class:"section-card"},Qa={class:"section-content"},Ja={class:"data-table"},Ka={class:"modal-header"},Xa={class:"modal-body"},Ya=["src","alt"],Za={key:0,class:"modal-body threat-detail-body"},ts={class:"detail-section"},as={class:"excel-table"},ss={class:"detail-section"},ls={class:"excel-table"},es={class:"stride-badge"},ns={class:"text-left"},is={class:"text-left"},os={class:"detail-section"},ds={class:"excel-table"},rs={class:"calc-value"},us={class:"calc-value"},cs={class:"calc-value"},vs={class:"calc-value"},_s={class:"calc-value highlight"},hs={class:"detail-section"},ps={class:"excel-table"},ms={class:"note-cell"},fs={class:"calc-value"},ys={class:"note-cell"},ks={class:"calc-value"},gs={class:"note-cell"},bs={class:"calc-value"},ws={class:"note-cell"},xs={class:"calc-value"},Cs={class:"calc-value highlight"},Ms={class:"detail-section"},Is={class:"excel-table"},As={class:"text-left"},Rs={key:0,class:"detail-section"},Ls={class:"excel-table"},Ss={key:0},Ds={key:1},Vs={key:2},Ts={key:3},Bs={key:4},$s={key:5},Fs={key:6},qs={key:0},Ns={key:1},Es={key:2},Us={key:3},zs={key:4},Hs={key:5},Ws={key:6,class:"text-left"},Ps={__name:"ReportDetailView",setup(js){const nt=kt(),$=C(!0),r=C(null),y=C({show:!1,url:"",title:""}),e=C({show:!1,data:null}),it=f(()=>r.value?wt(r.value.id):""),I=f(()=>{var s,a;return((a=(s=r.value)==null?void 0:s.assets)==null?void 0:a.assets)||[]}),A=f(()=>{var s,a;return((a=(s=r.value)==null?void 0:s.tara_results)==null?void 0:a.results)||[]}),R=f(()=>{var s,a;return((a=(s=r.value)==null?void 0:s.attack_trees)==null?void 0:a.attack_trees)||[]}),F=f(()=>{var s,a;return((a=(s=r.value)==null?void 0:s.definitions)==null?void 0:a.terminology)||[]}),L=f(()=>{var a,c;if(!((c=(a=r.value)==null?void 0:a.definitions)!=null&&c.assumptions))return[];const s=r.value.definitions.assumptions;return Array.isArray(s)?s.map((v,_)=>typeof v=="string"?{id:`å‡è®¾${_+1}`,description:v}:{id:v.id||v.assumption_id||`å‡è®¾${_+1}`,description:v.description||v.content||v.text||v}):[]}),ot=f(()=>{var c,v;const s=((c=r.value)==null?void 0:c.definitions)||{},a=((v=r.value)==null?void 0:v.assets)||{};return s.item_boundary_image||s.system_architecture_image||s.software_architecture_image||a.dataflow_image});yt(async()=>{const s=nt.params.id;try{const a=await gt(s);r.value=a}catch(a){console.error("è·å–æŠ¥å‘Šè¯¦æƒ…å¤±è´¥:",a)}finally{$.value=!1}});function q(s){return new Date(s).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function k(s){if(!s)return"";if(s.startsWith("/api/")||s.startsWith("http"))return s;const a=s.match(/IMG-[a-f0-9]+/i);return a?bt(a[0]):s}function dt(s){return{ä¸¥é‡çš„:"critical",é‡å¤§çš„:"high",ä¸­ç­‰çš„:"medium",å¯å¿½ç•¥ä¸è®¡çš„:"low"}[s]||"medium"}function b(s,a){y.value={show:!0,url:k(s),title:a}}function N(){y.value={show:!1,url:"",title:""}}function E(s){e.value={show:!0,data:s}}function U(){e.value={show:!1,data:null}}function z(s){return s&&{Critical:"risk-critical",å…³é”®:"risk-critical",High:"risk-high",é«˜:"risk-high",Medium:"risk-medium",ä¸­:"risk-medium",Low:"risk-low",ä½:"risk-low",QM:"risk-qm"}[s]||""}function rt(s){return s&&{å¾ˆé«˜:"feasibility-very-high",é«˜:"feasibility-high",ä¸­:"feasibility-medium",ä½:"feasibility-low",å¾ˆä½:"feasibility-very-low"}[s]||""}function x(s){return s&&{ä¸¥é‡çš„:"impact-severe",é‡å¤§çš„:"impact-major",ä¸­ç­‰çš„:"impact-moderate",å¯å¿½ç•¥ä¸è®¡çš„:"impact-negligible"}[s]||""}function ut(s){return s&&{ä¸¥é‡çš„:"level-severe",é‡å¤§çš„:"level-major",ä¸­ç­‰çš„:"level-moderate",å¯å¿½ç•¥ä¸è®¡çš„:"level-negligible",æ— å½±å“:"level-none"}[s]||""}function ct(s){return{å¯å¿½ç•¥ä¸è®¡çš„:"æ²¡æœ‰å—ä¼¤",ä¸­ç­‰çš„:"è½»ä¼¤å’Œä¸­ç­‰ä¼¤å®³",é‡å¤§çš„:"ä¸¥é‡ä¼¤å®³(ç”Ÿå­˜æ¦‚ç‡é«˜)",ä¸¥é‡çš„:"å±åŠç”Ÿå‘½(ç”Ÿå­˜æ¦‚ç‡ä¸ç¡®å®š)æˆ–è‡´å‘½ä¼¤å®³"}[s]||"-"}function vt(s){return{å¯å¿½ç•¥ä¸è®¡çš„:"è´¢åŠ¡æŸå¤±ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“",ä¸­ç­‰çš„:"è´¢åŠ¡æŸå¤±ä¼šäº§ç”Ÿä¸­ç­‰å½±å“",é‡å¤§çš„:"è´¢åŠ¡æŸå¤±ä¼šäº§ç”Ÿé‡å¤§å½±å“",ä¸¥é‡çš„:"è´¢åŠ¡æŸå¤±ä¼šäº§ç”Ÿä¸¥é‡å½±å“"}[s]||"-"}function _t(s){return{å¯å¿½ç•¥ä¸è®¡çš„:"æ“ä½œæŸåä¸ä¼šå¯¼è‡´è½¦è¾†åŠŸèƒ½å‡å°‘",ä¸­ç­‰çš„:"æ“ä½œæŸåä¼šå¯¼è‡´è½¦è¾†åŠŸèƒ½ä¸­ç­‰å‡å°‘",é‡å¤§çš„:"æ“ä½œæŸåä¼šå¯¼è‡´è½¦è¾†åŠŸèƒ½é‡å¤§å‡å°‘",ä¸¥é‡çš„:"æ“ä½œæŸåä¼šå¯¼è‡´è½¦è¾†åŠŸèƒ½ä¸§å¤±"}[s]||"-"}function ht(s){return{å¯å¿½ç•¥ä¸è®¡çš„:"éšç§å±å®³ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“",ä¸­ç­‰çš„:"éšç§å±å®³ä¼šäº§ç”Ÿä¸­ç­‰å½±å“",é‡å¤§çš„:"éšç§å±å®³ä¼šäº§ç”Ÿé‡å¤§å½±å“",ä¸¥é‡çš„:"éšç§å±å®³ä¼šäº§ç”Ÿä¸¥é‡å½±å“"}[s]||"-"}function H(s){return{ç½‘ç»œ:.85,é‚»å±…:.62,æœ¬åœ°:.55,ç‰©ç†:.2}[s]??0}function W(s){return{ä½:.77,é«˜:.44}[s]??0}function P(s){return{æ— :.85,ä½:.62,é«˜:.27}[s]??0}function j(s){return{ä¸éœ€è¦:.85,éœ€è¦:.62}[s]??0}function G(s){const a=H(s.attack_vector),c=W(s.attack_complexity),v=P(s.privileges_required||s.privilege_required),_=j(s.user_interaction);return(8.22*a*c*v*_).toFixed(2)}function S(s){const a=parseFloat(G(s));return a<=1.05?"å¾ˆä½":a<=1.99?"ä½":a<=2.99?"ä¸­":a<=3.99?"é«˜":"å¾ˆé«˜"}function p(s){return{å¯å¿½ç•¥ä¸è®¡çš„:0,ä¸­ç­‰çš„:1,é‡å¤§çš„:10,ä¸¥é‡çš„:1e3}[s]??0}function O(s){const a=p(s.safety_impact),c=p(s.financial_impact),v=p(s.operational_impact),_=p(s.privacy_impact);return a+c+v+_}function D(s){const a=O(s);return a>=1e3?"ä¸¥é‡çš„":a>=100?"é‡å¤§çš„":a>=10?"ä¸­ç­‰çš„":a>=1?"å¯å¿½ç•¥ä¸è®¡çš„":"æ— å½±å“"}function V(s){const a=D(s),c=S(s);return a==="æ— å½±å“"&&c==="æ— "?"QM":a==="æ— å½±å“"&&c!=="æ— "||a==="å¯å¿½ç•¥ä¸è®¡çš„"&&["å¾ˆä½","ä½","ä¸­"].includes(c)||a==="ä¸­ç­‰çš„"&&["å¾ˆä½","ä½"].includes(c)||a==="é‡å¤§çš„"&&c==="å¾ˆä½"?"Low":a==="å¯å¿½ç•¥ä¸è®¡çš„"&&["é«˜","å¾ˆé«˜"].includes(c)||a==="ä¸­ç­‰çš„"&&c==="ä¸­"||a==="é‡å¤§çš„"&&c==="ä½"||a==="ä¸¥é‡çš„"&&c==="å¾ˆä½"?"Medium":a==="ä¸­ç­‰çš„"&&["é«˜","å¾ˆé«˜"].includes(c)||a==="é‡å¤§çš„"&&c==="ä¸­"||a==="ä¸¥é‡çš„"&&c==="ä½"?"High":"Critical"}function Q(s){const a=V(s);return a==="QM"||a==="Low"?"ä¿ç•™é£é™©":a==="Medium"?"é™ä½é£é™©":"é™ä½é£é™©/è§„é¿é£é™©/è½¬ç§»é£é™©"}function pt(s){const a=Q(s);return a==="ä¿ç•™é£é™©"?"/":a==="é™ä½é£é™©"||a==="é™ä½é£é™©/è§„é¿é£é™©/è½¬ç§»é£é™©"?"éœ€è¦å®šä¹‰å®‰å…¨ç›®æ ‡":""}function mt(s){return{Tç¯¡æ”¹:"M10",Dæ‹’ç»æœåŠ¡:"M13",Iä¿¡æ¯æ³„éœ²:"M11",Sæ¬ºéª—:"M23",RæŠµèµ–:"M24",Eæƒé™æå‡:"M16"}[s]||"-"}return(s,a)=>{var c,v,_,T,J,K,X,Y,Z,tt,at,st,lt;return d(),o("div",xt,[$.value?(d(),o("div",Ct,[...a[7]||(a[7]=[t("svg",{class:"animate-spin",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("circle",{cx:"12",cy:"12",r:"10","stroke-opacity":"0.25"}),t("path",{d:"M12 2a10 10 0 0110 10","stroke-linecap":"round"})],-1),t("span",null,"åŠ è½½ä¸­...",-1)])])):r.value?(d(),o(g,{key:1},[t("div",Mt,[t("div",It,[t("button",{class:"btn-back",onClick:a[0]||(a[0]=i=>s.$router.back())},[...a[8]||(a[8]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("polyline",{points:"15 18 9 12 15 6"})],-1),n(" è¿”å› ",-1)])]),t("div",At,[t("h1",null,l(r.value.name),1),t("div",Rt,[a[10]||(a[10]=t("span",{class:"badge badge-success"},"å·²å®Œæˆ",-1)),t("span",Lt,[a[9]||(a[9]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("polyline",{points:"12 6 12 12 16 14"})],-1)),n(" "+l(q(r.value.created_at)),1)])])])]),t("div",St,[t("a",{href:it.value,class:"btn btn-primary",download:""},[...a[11]||(a[11]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),t("polyline",{points:"7,10 12,15 17,10"}),t("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1),n(" ä¸‹è½½æŠ¥å‘Š ",-1)])],8,Dt)])]),t("div",Vt,[t("div",Tt,[a[13]||(a[13]=M('<div class="stat-icon blue" data-v-9a8f260d><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-9a8f260d><rect x="2" y="3" width="20" height="14" rx="2" data-v-9a8f260d></rect><path d="M8 21h8" data-v-9a8f260d></path><path d="M12 17v4" data-v-9a8f260d></path></svg></div>',1)),t("div",Bt,[t("span",$t,l(((c=r.value.statistics)==null?void 0:c.assets_count)||0),1),a[12]||(a[12]=t("span",{class:"stat-label"},"èµ„äº§æ•°é‡",-1))])]),t("div",Ft,[a[15]||(a[15]=M('<div class="stat-icon yellow" data-v-9a8f260d><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-9a8f260d><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z" data-v-9a8f260d></path><line x1="12" y1="9" x2="12" y2="13" data-v-9a8f260d></line><line x1="12" y1="17" x2="12.01" y2="17" data-v-9a8f260d></line></svg></div>',1)),t("div",qt,[t("span",Nt,l(((v=r.value.statistics)==null?void 0:v.threats_count)||0),1),a[14]||(a[14]=t("span",{class:"stat-label"},"å¨èƒåœºæ™¯",-1))])]),t("div",Et,[a[17]||(a[17]=M('<div class="stat-icon red" data-v-9a8f260d><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-9a8f260d><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10" data-v-9a8f260d></path><path d="m14.5 9-5 5" data-v-9a8f260d></path><path d="m9.5 9 5 5" data-v-9a8f260d></path></svg></div>',1)),t("div",Ut,[t("span",zt,l(((_=r.value.statistics)==null?void 0:_.high_risk_count)||0),1),a[16]||(a[16]=t("span",{class:"stat-label"},"é«˜é£é™©é¡¹",-1))])]),t("div",Ht,[a[19]||(a[19]=t("div",{class:"stat-icon green"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"}),t("path",{d:"m9 12 2 2 4-4"})])],-1)),t("div",Wt,[t("span",Pt,l(((T=r.value.statistics)==null?void 0:T.measures_count)||0),1),a[18]||(a[18]=t("span",{class:"stat-label"},"å®‰å…¨æªæ–½",-1))])])]),t("div",jt,[a[27]||(a[27]=t("h2",null,"é¡¹ç›®ä¿¡æ¯",-1)),t("div",Gt,[a[26]||(a[26]=t("p",{class:"section-desc"},"æœ¬æŠ¥å‘ŠåŸºäº ISO/SAE 21434 æ ‡å‡†ï¼Œå¯¹ç›®æ ‡ç³»ç»Ÿè¿›è¡Œäº†å…¨é¢çš„å¨èƒåˆ†æå’Œé£é™©è¯„ä¼° (TARA)ã€‚",-1)),t("div",Ot,[t("div",Qt,[a[20]||(a[20]=t("span",{class:"info-label"},"é¡¹ç›®åç§°",-1)),t("span",Jt,l(r.value.project_name),1)]),t("div",Kt,[a[21]||(a[21]=t("span",{class:"info-label"},"æŠ¥å‘Šæ ‡é¢˜",-1)),t("span",Xt,l(((J=r.value.cover)==null?void 0:J.report_title)||r.value.name),1)]),t("div",Yt,[a[22]||(a[22]=t("span",{class:"info-label"},"æ–‡æ¡£ç¼–å·",-1)),t("span",Zt,l(((K=r.value.cover)==null?void 0:K.document_number)||"-"),1)]),t("div",ta,[a[23]||(a[23]=t("span",{class:"info-label"},"ç‰ˆæœ¬",-1)),t("span",aa,l(((X=r.value.cover)==null?void 0:X.version)||"V1.0"),1)]),t("div",sa,[a[24]||(a[24]=t("span",{class:"info-label"},"æ•°æ®ç­‰çº§",-1)),t("span",la,l(((Y=r.value.cover)==null?void 0:Y.data_level)||"ç§˜å¯†"),1)]),t("div",ea,[a[25]||(a[25]=t("span",{class:"info-label"},"ç”Ÿæˆæ—¶é—´",-1)),t("span",na,l(q(r.value.created_at)),1)])])])]),ot.value?(d(),o("div",ia,[a[32]||(a[32]=t("h2",null,"æ¶æ„å›¾",-1)),t("div",oa,[t("div",da,[(Z=r.value.definitions)!=null&&Z.item_boundary_image?(d(),o("div",{key:0,class:"image-card",onClick:a[1]||(a[1]=i=>b(r.value.definitions.item_boundary_image,"é¡¹ç›®è¾¹ç•Œå›¾"))},[t("img",{src:k(r.value.definitions.item_boundary_image),alt:"é¡¹ç›®è¾¹ç•Œå›¾"},null,8,ra),a[28]||(a[28]=t("div",{class:"image-title"},"é¡¹ç›®è¾¹ç•Œå›¾",-1))])):u("",!0),(tt=r.value.definitions)!=null&&tt.system_architecture_image?(d(),o("div",{key:1,class:"image-card",onClick:a[2]||(a[2]=i=>b(r.value.definitions.system_architecture_image,"ç³»ç»Ÿæ¶æ„å›¾"))},[t("img",{src:k(r.value.definitions.system_architecture_image),alt:"ç³»ç»Ÿæ¶æ„å›¾"},null,8,ua),a[29]||(a[29]=t("div",{class:"image-title"},"ç³»ç»Ÿæ¶æ„å›¾",-1))])):u("",!0),(at=r.value.definitions)!=null&&at.software_architecture_image?(d(),o("div",{key:2,class:"image-card",onClick:a[3]||(a[3]=i=>b(r.value.definitions.software_architecture_image,"è½¯ä»¶æ¶æ„å›¾"))},[t("img",{src:k(r.value.definitions.software_architecture_image),alt:"è½¯ä»¶æ¶æ„å›¾"},null,8,ca),a[30]||(a[30]=t("div",{class:"image-title"},"è½¯ä»¶æ¶æ„å›¾",-1))])):u("",!0),(st=r.value.assets)!=null&&st.dataflow_image?(d(),o("div",{key:3,class:"image-card",onClick:a[4]||(a[4]=i=>b(r.value.assets.dataflow_image,"æ•°æ®æµå›¾"))},[t("img",{src:k(r.value.assets.dataflow_image),alt:"æ•°æ®æµå›¾"},null,8,va),a[31]||(a[31]=t("div",{class:"image-title"},"æ•°æ®æµå›¾",-1))])):u("",!0)])])])):u("",!0),(lt=r.value.definitions)!=null&&lt.functional_description?(d(),o("div",_a,[a[33]||(a[33]=t("h2",null,"åŠŸèƒ½æè¿°",-1)),t("div",ha,[t("p",pa,l(r.value.definitions.functional_description),1)])])):u("",!0),L.value.length>0?(d(),o("div",ma,[t("h2",null,"ç›¸å…³é¡¹å‡è®¾ ("+l(L.value.length)+")",1),t("div",fa,[t("table",ya,[a[34]||(a[34]=t("thead",null,[t("tr",null,[t("th",null,"å‡è®¾ç¼–å·"),t("th",null,"å‡è®¾æè¿°")])],-1)),t("tbody",null,[(d(!0),o(g,null,w(L.value,(i,m)=>(d(),o("tr",{key:m},[t("td",null,l(i.id),1),t("td",null,l(i.description),1)]))),128))])])])])):u("",!0),I.value.length>0?(d(),o("div",ka,[t("h2",null,"èµ„äº§æ¸…å• ("+l(I.value.length)+")",1),t("div",ga,[t("table",ba,[a[35]||(a[35]=t("thead",null,[t("tr",null,[t("th",null,"èµ„äº§ID"),t("th",null,"èµ„äº§åç§°"),t("th",null,"åˆ†ç±»"),t("th",null,"å¤‡æ³¨"),t("th",null,"å®‰å…¨å±æ€§")])],-1)),t("tbody",null,[(d(!0),o(g,null,w(I.value,i=>(d(),o("tr",{key:i.id},[t("td",null,l(i.id),1),t("td",null,l(i.name),1),t("td",null,l(i.category),1),t("td",null,l(i.remarks),1),t("td",null,[i.authenticity?(d(),o("span",wa,"çœŸå®æ€§")):u("",!0),i.integrity?(d(),o("span",xa,"å®Œæ•´æ€§")):u("",!0),i.availability?(d(),o("span",Ca,"å¯ç”¨æ€§")):u("",!0),i.confidentiality?(d(),o("span",Ma,"æœºå¯†æ€§")):u("",!0)])]))),128))])])])])):u("",!0),R.value.length>0?(d(),o("div",Ia,[t("h2",null,"æ”»å‡»æ ‘åˆ†æ ("+l(R.value.length)+")",1),t("div",Aa,[t("div",Ra,[(d(!0),o(g,null,w(R.value,(i,m)=>(d(),o("div",{key:m,class:"attack-tree-card"},[t("div",La,[t("div",Sa,[t("span",Da,l(i.asset_id||`AT${String(m+1).padStart(3,"0")}`),1),t("span",Va,l(i.asset_name||i.title||`æ”»å‡»æ ‘ ${m+1}`),1)])]),t("div",Ta,[i.image||i.image_url||i.attack_tree_image?(d(),o("div",{key:0,class:"tree-image",onClick:et=>b(i.image||i.image_url||i.attack_tree_image,i.asset_name||i.title||`æ”»å‡»æ ‘ ${m+1}`)},[t("img",{src:k(i.image||i.image_url||i.attack_tree_image),alt:i.asset_name||i.title},null,8,$a),a[36]||(a[36]=t("div",{class:"image-overlay"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),t("circle",{cx:"12",cy:"12",r:"3"})]),t("span",null,"ç‚¹å‡»æŸ¥çœ‹å¤§å›¾")],-1))],8,Ba)):(d(),o("div",Fa,[...a[37]||(a[37]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),t("path",{d:"M21 15l-5-5L5 21"})],-1),t("span",null,"æš‚æ— æ”»å‡»æ ‘å›¾ç‰‡",-1)])]))]),i.description||i.title?(d(),o("div",qa,[i.title?(d(),o("p",Na,l(i.title),1)):u("",!0),i.description?(d(),o("p",Ea,l(i.description),1)):u("",!0)])):u("",!0)]))),128))])])])):u("",!0),A.value.length>0?(d(),o("div",Ua,[t("h2",null,"å¨èƒåˆ†æç»“æœ ("+l(A.value.length)+")",1),t("div",za,[a[40]||(a[40]=t("p",{class:"table-hint"},"ç‚¹å‡»ä»»æ„è¡Œå¯æŸ¥çœ‹å¨èƒè¯¦æƒ…",-1)),t("table",Ha,[a[39]||(a[39]=t("thead",null,[t("tr",null,[t("th",null,"èµ„äº§ID"),t("th",null,"èµ„äº§åç§°"),t("th",null,"STRIDE"),t("th",null,"å¨èƒåœºæ™¯"),t("th",null,"æ”»å‡»å‘é‡"),t("th",null,"å½±å“ç­‰çº§"),t("th",null,"æ“ä½œ")])],-1)),t("tbody",null,[(d(!0),o(g,null,w(A.value,(i,m)=>(d(),o("tr",{key:m,onClick:et=>E(i)},[t("td",null,l(i.asset_id),1),t("td",null,l(i.asset_name),1),t("td",null,[t("span",Pa,l(i.stride_model),1)]),t("td",ja,l(i.threat_scenario),1),t("td",null,l(i.attack_vector),1),t("td",null,[t("span",{class:h(["impact-badge",dt(i.operational_impact)])},l(i.operational_impact),3)]),t("td",null,[t("button",{class:"btn-view-detail",onClick:B(et=>E(i),["stop"])},[...a[38]||(a[38]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),t("circle",{cx:"12",cy:"12",r:"3"})],-1),n(" è¯¦æƒ… ",-1)])],8,Ga)])],8,Wa))),128))])])])])):u("",!0),F.value.length>0?(d(),o("div",Oa,[a[42]||(a[42]=t("h2",null,"æœ¯è¯­è¡¨",-1)),t("div",Qa,[t("table",Ja,[a[41]||(a[41]=t("thead",null,[t("tr",null,[t("th",null,"ç¼©å†™"),t("th",null,"è‹±æ–‡å…¨ç§°"),t("th",null,"ä¸­æ–‡åç§°")])],-1)),t("tbody",null,[(d(!0),o(g,null,w(F.value,i=>(d(),o("tr",{key:i.abbreviation},[t("td",null,l(i.abbreviation),1),t("td",null,l(i.english),1),t("td",null,l(i.chinese),1)]))),128))])])])])):u("",!0)],64)):u("",!0),y.value.show?(d(),o("div",{key:2,class:"modal-overlay",onClick:N},[t("div",{class:"modal-content image-modal",onClick:a[5]||(a[5]=B(()=>{},["stop"]))},[t("div",Ka,[t("h3",null,l(y.value.title),1),t("button",{class:"btn-close",onClick:N},[...a[43]||(a[43]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),t("div",Xa,[t("img",{src:y.value.url,alt:y.value.title},null,8,Ya)])])])):u("",!0),e.value.show?(d(),o("div",{key:3,class:"modal-overlay",onClick:U},[t("div",{class:"modal-content threat-modal",onClick:a[6]||(a[6]=B(()=>{},["stop"]))},[t("div",{class:"modal-header"},[a[45]||(a[45]=t("h3",null,"å¨èƒåˆ†æè¯¦æƒ… - TARA Results",-1)),t("button",{class:"btn-close",onClick:U},[...a[44]||(a[44]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),e.value.data?(d(),o("div",Za,[t("div",ts,[a[47]||(a[47]=t("h4",null,"ğŸ“‹ èµ„äº§ä¿¡æ¯ Asset Information",-1)),t("table",as,[a[46]||(a[46]=t("thead",null,[t("tr",null,[t("th",null,[n("Asset ID"),t("br"),n("èµ„äº§ID")]),t("th",null,[n("Asset Name"),t("br"),n("èµ„äº§åç§°")]),t("th",null,"ç»†åˆ†ç±»-å­é¢†åŸŸä¸€"),t("th",null,"ç»†åˆ†ç±»-å­é¢†åŸŸäºŒ"),t("th",null,"ç»†åˆ†ç±»-å­é¢†åŸŸä¸‰"),t("th",null,[n("Category"),t("br"),n("åˆ†ç±»")]),t("th",null,[n("Security Attributes"),t("br"),n("å®‰å…¨å±æ€§")])])],-1)),t("tbody",null,[t("tr",null,[t("td",null,l(e.value.data.asset_id||"-"),1),t("td",null,l(e.value.data.asset_name||"-"),1),t("td",null,l(e.value.data.subdomain1||"-"),1),t("td",null,l(e.value.data.subdomain2||"-"),1),t("td",null,l(e.value.data.subdomain3||"-"),1),t("td",null,l(e.value.data.category||"-"),1),t("td",null,l(e.value.data.security_attribute||"-"),1)])])])]),t("div",ss,[a[49]||(a[49]=t("h4",null,"âš ï¸ å¨èƒåˆ†æ Threat Analysis",-1)),t("table",ls,[a[48]||(a[48]=t("thead",null,[t("tr",null,[t("th",null,[n("STRIDE Model"),t("br"),n("STRIDEæ¨¡å‹")]),t("th",null,[n("Potential Threat and Damage Scenario"),t("br"),n("æ½œåœ¨å¨èƒå’ŒæŸå®³åœºæ™¯")]),t("th",null,[n("Attack Path"),t("br"),n("æ”»å‡»è·¯å¾„")]),t("th",null,[n("æ¥æº"),t("br"),n("WP29å¨èƒæ˜ å°„")])])],-1)),t("tbody",null,[t("tr",null,[t("td",null,[t("span",es,l(e.value.data.stride_model||"-"),1)]),t("td",ns,l(e.value.data.threat_scenario||"-"),1),t("td",is,l(e.value.data.attack_path||"-"),1),t("td",null,l(e.value.data.wp29_mapping||"-"),1)])])])]),t("div",os,[a[51]||(a[51]=t("h4",null,"ğŸ¯ æ”»å‡»å¯è¡Œæ€§åˆ†æ Attack Feasibility Analysis",-1)),t("table",ds,[a[50]||(a[50]=t("thead",null,[t("tr",null,[t("th",{colspan:"2"},[n("Attack Vector(V)"),t("br"),n("æ”»å‡»å‘é‡")]),t("th",{colspan:"2"},[n("Attack Complexity(C)"),t("br"),n("æ”»å‡»å¤æ‚åº¦")]),t("th",{colspan:"2"},[n("Privileges Required(P)"),t("br"),n("æƒé™è¦æ±‚")]),t("th",{colspan:"2"},[n("User Interaction(U)"),t("br"),n("ç”¨æˆ·äº¤äº’")]),t("th",{colspan:"2"},[n("Attack Feasibility"),t("br"),n("æ”»å‡»å¯è¡Œæ€§è®¡ç®—")])]),t("tr",{class:"sub-header"},[t("th",null,"å†…å®¹"),t("th",null,"æŒ‡æ ‡å€¼"),t("th",null,"å†…å®¹"),t("th",null,"æŒ‡æ ‡å€¼"),t("th",null,"ç­‰çº§"),t("th",null,"æŒ‡æ ‡å€¼"),t("th",null,"ç­‰çº§"),t("th",null,"æŒ‡æ ‡å€¼"),t("th",null,"è®¡ç®—å€¼"),t("th",null,"ç­‰çº§")])],-1)),t("tbody",null,[t("tr",null,[t("td",null,l(e.value.data.attack_vector||"-"),1),t("td",rs,l(H(e.value.data.attack_vector)),1),t("td",null,l(e.value.data.attack_complexity||"-"),1),t("td",us,l(W(e.value.data.attack_complexity)),1),t("td",null,l(e.value.data.privileges_required||e.value.data.privilege_required||"-"),1),t("td",cs,l(P(e.value.data.privileges_required||e.value.data.privilege_required)),1),t("td",null,l(e.value.data.user_interaction||"-"),1),t("td",vs,l(j(e.value.data.user_interaction)),1),t("td",_s,l(G(e.value.data)),1),t("td",null,[t("span",{class:h(["feasibility-badge",rt(S(e.value.data))])},l(S(e.value.data)),3)])])])])]),t("div",hs,[a[53]||(a[53]=t("h4",null,"ğŸ’¥ å½±å“åˆ†æ Impact Analysis",-1)),t("table",ps,[a[52]||(a[52]=t("thead",null,[t("tr",null,[t("th",{colspan:"3"},[n("Safety"),t("br"),n("å®‰å…¨")]),t("th",{colspan:"3"},[n("Financial"),t("br"),n("ç»æµ")]),t("th",{colspan:"3"},[n("Operational"),t("br"),n("æ“ä½œ")]),t("th",{colspan:"3"},[n("Privacy & Legislation"),t("br"),n("éšç§å’Œæ³•å¾‹")]),t("th",{colspan:"2"},[n("Impact Level Calculation"),t("br"),n("å½±å“ç­‰çº§è®¡ç®—")])]),t("tr",{class:"sub-header"},[t("th",null,"å†…å®¹"),t("th",null,"æ³¨é‡Š"),t("th",null,"æŒ‡æ ‡å€¼"),t("th",null,"å†…å®¹"),t("th",null,"æ³¨é‡Š"),t("th",null,"æŒ‡æ ‡å€¼"),t("th",null,"å†…å®¹"),t("th",null,"æ³¨é‡Š"),t("th",null,"æŒ‡æ ‡å€¼"),t("th",null,"å†…å®¹"),t("th",null,"æ³¨é‡Š"),t("th",null,"æŒ‡æ ‡å€¼"),t("th",null,"å½±å“è®¡ç®—"),t("th",null,"å½±å“ç­‰çº§")])],-1)),t("tbody",null,[t("tr",null,[t("td",null,[t("span",{class:h(["impact-value",x(e.value.data.safety_impact)])},l(e.value.data.safety_impact||"-"),3)]),t("td",ms,l(ct(e.value.data.safety_impact)),1),t("td",fs,l(p(e.value.data.safety_impact)),1),t("td",null,[t("span",{class:h(["impact-value",x(e.value.data.financial_impact)])},l(e.value.data.financial_impact||"-"),3)]),t("td",ys,l(vt(e.value.data.financial_impact)),1),t("td",ks,l(p(e.value.data.financial_impact)),1),t("td",null,[t("span",{class:h(["impact-value",x(e.value.data.operational_impact)])},l(e.value.data.operational_impact||"-"),3)]),t("td",gs,l(_t(e.value.data.operational_impact)),1),t("td",bs,l(p(e.value.data.operational_impact)),1),t("td",null,[t("span",{class:h(["impact-value",x(e.value.data.privacy_impact)])},l(e.value.data.privacy_impact||"-"),3)]),t("td",ws,l(ht(e.value.data.privacy_impact)),1),t("td",xs,l(p(e.value.data.privacy_impact)),1),t("td",Cs,l(O(e.value.data)),1),t("td",null,[t("span",{class:h(["impact-level-badge",ut(D(e.value.data))])},l(D(e.value.data)),3)])])])])]),t("div",Ms,[a[55]||(a[55]=t("h4",null,"ğŸ“Š é£é™©è¯„ä¼°ä¸å®‰å…¨éœ€æ±‚ Risk Assessment & Security Requirements",-1)),t("table",Is,[a[54]||(a[54]=t("thead",null,[t("tr",null,[t("th",null,[n("Risk Level"),t("br"),n("é£é™©ç­‰çº§")]),t("th",null,[n("Risk Treatment Decision"),t("br"),n("é£é™©å¤„ç½®å†³ç­–")]),t("th",null,[n("Security Goal"),t("br"),n("å®‰å…¨ç›®æ ‡")]),t("th",null,[n("Security Requirement"),t("br"),n("å®‰å…¨éœ€æ±‚")]),t("th",null,[n("Sourceæ¥æº"),t("br"),n("WP29 Control Mapping")])])],-1)),t("tbody",null,[t("tr",null,[t("td",null,[t("span",{class:h(["risk-badge",z(V(e.value.data))])},l(V(e.value.data)),3)]),t("td",null,l(Q(e.value.data)),1),t("td",null,l(pt(e.value.data)),1),t("td",As,l(e.value.data.security_requirement||e.value.data.security_measure||"-"),1),t("td",null,l(mt(e.value.data.stride_model)),1)])])])]),e.value.data.threat_id||e.value.data.remarks||e.value.data.residual_risk?(d(),o("div",Rs,[a[62]||(a[62]=t("h4",null,"ğŸ“ å…¶ä»–ä¿¡æ¯ Additional Information",-1)),t("table",Ls,[t("thead",null,[t("tr",null,[e.value.data.threat_id?(d(),o("th",Ss,[...a[56]||(a[56]=[n("Threat ID",-1),t("br",null,null,-1),n("å¨èƒID",-1)])])):u("",!0),e.value.data.residual_risk?(d(),o("th",Ds,[...a[57]||(a[57]=[n("Residual Risk",-1),t("br",null,null,-1),n("æ®‹ä½™é£é™©",-1)])])):u("",!0),e.value.data.effectiveness?(d(),o("th",Vs,[...a[58]||(a[58]=[n("Effectiveness",-1),t("br",null,null,-1),n("æœ‰æ•ˆæ€§",-1)])])):u("",!0),e.value.data.cal?(d(),o("th",Ts,"CAL")):u("",!0),e.value.data.component?(d(),o("th",Bs,[...a[59]||(a[59]=[n("Component",-1),t("br",null,null,-1),n("ç»„ä»¶",-1)])])):u("",!0),e.value.data.status?(d(),o("th",$s,[...a[60]||(a[60]=[n("Status",-1),t("br",null,null,-1),n("çŠ¶æ€",-1)])])):u("",!0),e.value.data.remarks?(d(),o("th",Fs,[...a[61]||(a[61]=[n("Remarks",-1),t("br",null,null,-1),n("å¤‡æ³¨",-1)])])):u("",!0)])]),t("tbody",null,[t("tr",null,[e.value.data.threat_id?(d(),o("td",qs,l(e.value.data.threat_id),1)):u("",!0),e.value.data.residual_risk?(d(),o("td",Ns,[t("span",{class:h(["risk-badge",z(e.value.data.residual_risk)])},l(e.value.data.residual_risk),3)])):u("",!0),e.value.data.effectiveness?(d(),o("td",Es,l(e.value.data.effectiveness),1)):u("",!0),e.value.data.cal?(d(),o("td",Us,l(e.value.data.cal),1)):u("",!0),e.value.data.component?(d(),o("td",zs,l(e.value.data.component),1)):u("",!0),e.value.data.status?(d(),o("td",Hs,l(e.value.data.status),1)):u("",!0),e.value.data.remarks?(d(),o("td",Ws,l(e.value.data.remarks),1)):u("",!0)])])])])):u("",!0),a[63]||(a[63]=M('<div class="detail-section formula-section" data-v-9a8f260d><h4 data-v-9a8f260d>ğŸ“ è®¡ç®—å…¬å¼è¯´æ˜ Calculation Formulas</h4><div class="formula-list" data-v-9a8f260d><div class="formula-item" data-v-9a8f260d><span class="formula-label" data-v-9a8f260d>æ”»å‡»å¯è¡Œæ€§è®¡ç®—:</span><code data-v-9a8f260d>8.22 Ã— æ”»å‡»å‘é‡å€¼ Ã— æ”»å‡»å¤æ‚åº¦å€¼ Ã— æƒé™è¦æ±‚å€¼ Ã— ç”¨æˆ·äº¤äº’å€¼</code></div><div class="formula-item" data-v-9a8f260d><span class="formula-label" data-v-9a8f260d>å½±å“è®¡ç®—:</span><code data-v-9a8f260d>å®‰å…¨æŒ‡æ ‡å€¼ + ç»æµæŒ‡æ ‡å€¼ + æ“ä½œæŒ‡æ ‡å€¼ + éšç§æŒ‡æ ‡å€¼</code></div><div class="formula-item" data-v-9a8f260d><span class="formula-label" data-v-9a8f260d>æŒ‡æ ‡å€¼æ˜ å°„:</span><code data-v-9a8f260d>å¯å¿½ç•¥ä¸è®¡çš„=0, ä¸­ç­‰çš„=1, é‡å¤§çš„=10, ä¸¥é‡çš„=1000</code></div></div></div>',1))])):u("",!0)])])):u("",!0)])}}},Qs=ft(Ps,[["__scopeId","data-v-9a8f260d"]]);export{Qs as default};
